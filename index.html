<!DOCTYPE html>
<html>

<head>
    <title>India Data Visualisation</title>
    <script src="https://d3js.org/d3.v4.min.js"></script>
</head>

<body>
</body>
<script type="text/javascript">
var url = './crime-against-women.json'

d3.json(url, function(json) {
    var rape_victims = []
    for (var i = 0; i < json.data.length; i++) {
        if (json.data[i][1] == 'RAPE' && json.data[i][0].indexOf('TOTAL') < 0) {
            rape_victims.push(json.data[i])
        }
    }
    console.log(rape_victims)
    var heading = d3.select('body').append("h2")
    .attr("style", "margin-left: 10%;")
    .text("Data visualization of rape victims in 2001")
    var canvas = d3.select('body')
        .append('svg')
        .attr('width', 1280)
        .attr('height', 800)
        .append('g')
    var elements = canvas.selectAll('g')
        .data(rape_victims)
        .enter()
        .append('g')
        elements.append('text')
            .attr('x', function(d, i) {
                return -770
            })
            .attr('y', function(d, i) {
                return 25+i*29
            })
            .attr('dy', '.35em')
            .text(function(d) {
                str = d[0][0] + d[0].slice(1).toLowerCase()
                return str
            })
            .attr("transform", function(d) {
                return "rotate(-90)"
            })
        var y = d3.scaleLinear()
    		.range([720, 0]);
   var bars =  elements.append('rect')
        .attr('width', 25)
        .attr('height', 0)
        .attr('x', function(d, i) {
            return i * 29 + 15
        })
        .attr('y', 650)
    bars.transition()
        .duration(2000)
        .attr('y', function(d) {
            return 650-d[2]/6
        })
        .attr('height', function(d) {
            return (d[2]/6)
        })
    var text = elements.append('text')
        .attr('x', function(d, i) {
            return i*29+15
        })
        .attr('y', 640)
        .text(function(d) {
            return d[2]
        })
        text.transition()
        .duration(2000)
        .attr('y', function(d, i) {
            return 645 - d[2]/6
        } )

})
</script>

</html>
